context Reservation
inv: self.client <> null
inv: self.connectionRouteId <> null and self.connectionRouteId.size() > 0
inv: self.ticket <> null
inv: self.isFirstClass = true implies self.ticket.oclIsTypeOf(FirstClassTicket)
inv: self.isFirstClass = false implies self.ticket.oclIsTypeOf(SecondClassTicket)
inv: self.reservationId <> null and Reservation.allInstances()->forAll(r | r <> self implies r.reservationId <> self.reservationId)
inv: self.trip <> null implies self.trip.reservations->includes(self)
inv: self.connection <> null implies self.connectionRouteId = self.connection.getRouteId()
inv positiveTicketPrice: self.ticket.getPrice() > 0


context Reservation::Reservation(client: Client, connection: Connection, isFirstClass: boolean)
pre: client <> null
pre: connection <> null
pre: (isFirstClass = true implies connection.getFirstClassTicket() <> null) and
     (isFirstClass = false implies connection.getSecondClassTicket() <> null)
post: self.client = client
post: self.connection = connection
post: self.connectionRouteId = connection.getRouteId()
post: self.isFirstClass = isFirstClass
post: self.ticket <> null
post: (isFirstClass = true implies self.ticket.oclIsTypeOf(FirstClassTicket)) and
      (isFirstClass = false implies self.ticket.oclIsTypeOf(SecondClassTicket))
post: (isFirstClass implies self.ticket.price = connection.firstClassTicket.price) and
      (not isFirstClass implies self.ticket.price = connection.secondClassTicket.price)

context Reservation::isFirstClass(): boolean
post: result = self.isFirstClass

